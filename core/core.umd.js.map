{"version":3,"file":null,"sources":["../src/ts/services/mapbox.service.ts","../src/ts/components/mapbox.component.ts","../src/ts/components/mapboxMarker.component.ts","../src/ts/components/mapboxMarkerDirection.component.ts","../src/ts/mapbox.module.ts"],"sourcesContent":["import { Injectable, Inject } from '@angular/core';\r\nvar mapboxgl = require(\"mapbox-gl/js/mapbox-gl.js\");\r\n\r\n@Injectable()\r\nexport class MapBoxService {\r\n\taccessToken: String;\r\n\tpublic map: any;\r\n\r\n  \tconstructor (@Inject('MAPBOX_KEY') _config: String) {\r\n      if(_config) this.accessToken = _config;\r\n    }\r\n\r\n    Map(options: Object) {\r\n\t\t\tmapboxgl.accessToken = this.accessToken;\r\n\r\n\t\t\tthis.map = new mapboxgl.Map(options);\r\n\r\n\t\t\treturn true; \r\n    }\r\n\r\n    Marker(el: any, options: Object, coordinates: number[]) {\r\n\t\tvar _self = this;\r\n\r\n\t\tsetTimeout(function() {\r\n\t\t\tnew mapboxgl.Marker(el, options)\r\n\t\t\t\t.setLngLat(coordinates)\r\n\t\t\t\t.addTo(_self.map);\r\n\t\t}, 100);\t\r\n    }\r\n\r\n\tflyTo(coordinates: Object, zoom: number) {\r\n\t\tvar _self = this;\r\n\r\n\t\tsetTimeout(function() {\r\n\t\t\t_self.map.flyTo({ center: coordinates, zoom: zoom });\r\n\t\t},100);\r\n\t}\r\n\r\n\tprevMarker() {\r\n\t\tconsole.log(this.map);\r\n\t}\r\n\r\n\tnextMarker() {\r\n\t\tconsole.log(this.map);\r\n\t}\r\n}","/*\r\n*\r\n* Mapbox component\r\n*\r\n*/\r\nimport { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\r\nimport { MapBoxService } from '../services/mapbox.service';\r\n\r\n@Component({\r\n\tselector: 'mapbox',\r\n  \ttemplate: `\r\n      <div style=\"position: relative; overflow: hidden;\">\r\n        <div [attr.id]=\"'map' + index\" style=\"min-height: 500px;\"></div>\r\n        <ng-content></ng-content>\r\n      </div>\r\n    `,\r\n    inputs: ['style', 'center', 'zoom', 'hash', 'index'],\r\n\tproviders: [MapBoxService]\r\n})\r\n\r\nexport class MapBoxComponent implements OnInit {\r\n\t@Output() state = new EventEmitter();\r\n\r\n    style: String = 'mapbox://styles/mapbox/streets-v9';\r\n    center: Object = [-5.646973, 52.087483];\r\n    zoom: number = 6;\r\n    hash: Boolean = false;\r\n\t\tpublic index: number = 0;\r\n\r\n\tconstructor(@Inject(MapBoxService) private _mapBoxService: MapBoxService) { }\r\n\r\n    ngOnInit() {\r\n\t\t\tvar _self = this;\r\n\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\t_self._mapBoxService.Map({\r\n\t\t\t\t\tcontainer: 'map' + _self.index,\r\n\t\t\t\t\tstyle: _self.style,\r\n\t\t\t\t\tcenter: _self.center, \r\n\t\t\t\t\tzoom: _self.zoom, \r\n\t\t\t\t\thash: _self.hash\r\n\t\t\t\t});\r\n\r\n\t\t\t\t_self.state.emit(\"Loaded\");\r\n\t\t\t}, 100);\r\n    }\r\n }","/*\r\n*\r\n* Mapbox Marker component\r\n*\r\n*/\r\nimport { Directive, Input, OnInit, Inject, Output, EventEmitter } from '@angular/core';\r\n\r\nimport { MapBoxService } from '../services/mapbox.service';\r\n\r\n@Directive({\r\n\tselector: 'mapbox-marker',\r\n\tinputs: ['image', 'width', 'height', 'coordinates', 'click', 'data', 'flyTo']\r\n})\r\n\r\nexport class MapBoxMarkerDirective implements OnInit {\r\n\t\timage: String;\r\n\t\twidth: number = 60;\r\n\t\theight: number = 60;\r\n\t\tcoordinates: number[];\r\n\t\tpopup: String;\r\n\t\tmap: Object;\r\n\t\tdata: Object;\r\n\t\tflyTo: number;\r\n\t\t@Output() click = new EventEmitter();\r\n\r\n\t\tconstructor(@Inject(MapBoxService) private _mapBoxService: MapBoxService) {}\r\n\r\n\t\tngOnInit() {\r\n\r\n\t\t\tvar _self = this;\r\n\t\t\tvar el = document.createElement('div');\r\n\r\n\t\t\tel.className = 'marker';\r\n\t\t\tel.style.backgroundImage = 'url(' + this.image + ')';\r\n\t\t\tel.style.backgroundRepeat = 'no-repeat';\r\n\t\t\tel.style.width = this.width + 'px';\t\r\n\t\t\tel.style.height = this.height + 'px';\r\n\r\n\t\t\tthis._mapBoxService.Marker(\r\n\t\t\t\tel, // element\r\n\t\t\t\t{offset: [-this.width / 2, -this.height / 2]}, // options\r\n\t\t\t\tthis.coordinates // coordinates\r\n\t\t\t);  \r\n\r\n\t\t\tel.addEventListener(\"click\", function() {\r\n\r\n\t\t\t\tif(_self.flyTo) {\r\n\t\t\t\t\t_self._mapBoxService.flyTo(_self.coordinates, _self.flyTo);\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t_self.click.emit({\r\n\t\t\t\t\tdata: _self.data,\r\n\t\t\t\t\tcoordinates: _self.coordinates\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n }","/*\r\n*\r\n* Mapbox Marker Directive component\r\n*\r\n*/\r\nimport { Component, Inject, Output, EventEmitter } from '@angular/core';\r\nimport { MapBoxService } from '../services/mapbox.service';\r\n\r\n@Component({\r\n\tselector: 'mapbox-marker-direction',\r\n  \ttemplate: `\r\n      <a (click)=\"action()\">\r\n        <ng-content></ng-content>\r\n      </a>\r\n    `,\r\n    inputs: ['direction'],\r\n\tproviders: [MapBoxService]\r\n})\r\n\r\nexport class MapBoxMarkerDirectionComponent {\r\n    direction: String = \"next\";\r\n\r\n\tconstructor(@Inject(MapBoxService) private _mapBoxService: MapBoxService) { }\r\n\r\n    action() {\r\n        if(this.direction === \"next\") {\r\n            this._mapBoxService.nextMarker();\r\n        } else {\r\n            this._mapBoxService.prevMarker();\r\n        }\r\n    }\r\n }","/*\r\n *\r\n * Mapbox module\r\n *\r\n * https://angular.io/docs/ts/latest/guide/ngmodule.html\r\n *\r\n */\r\nimport { NgModule, ModuleWithProviders }          from '@angular/core';\r\nimport { MapBoxComponent }                        from './components/mapbox.component';\r\nimport { MapBoxMarkerDirective }                  from './components/mapboxMarker.component';\r\nimport { MapBoxMarkerDirectionComponent }         from './components/mapboxMarkerDirection.component';\r\nimport { MapBoxService }                          from './services/mapbox.service';\r\n/*\r\n *\r\n * @NgModule\r\n *\r\n * The @NgModule decorator defines the metadata for the module.\r\n * \r\n * We'll take an intuitive approach to understanding the metadata and fill in details as we go.\r\n *\r\n */\r\n@NgModule({\r\n    exports: [\r\n        MapBoxComponent,\r\n        MapBoxMarkerDirective,\r\n        MapBoxMarkerDirectionComponent\r\n    ], \r\n    declarations: [\r\n        MapBoxComponent,\r\n        MapBoxMarkerDirective,\r\n        MapBoxMarkerDirectionComponent\r\n    ]\r\n})\r\nexport class MapBoxModule {\r\n    static forRoot(config: String): ModuleWithProviders {\r\n        return {\r\n            ngModule: MapBoxModule,\r\n            providers: [\r\n                { provide: 'MAPBOX_KEY', useValue: config }\r\n            ]\r\n        };\r\n    }\r\n }"],"names":["MapBoxService","Injectable","Inject","EventEmitter","Output","MapBoxComponent","Component","MapBoxMarkerDirective","Directive","MapBoxModule","NgModule"],"mappings":"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"}